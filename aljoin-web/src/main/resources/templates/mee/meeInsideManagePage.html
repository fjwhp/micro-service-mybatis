<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>内部会议管理</title>
<link rel="stylesheet" href="../../web/css/global.css" media="all">
<link rel="stylesheet" href="../../web/css/zTreeStyle.css" media="all">
<link rel="stylesheet" href="../../web/plugins/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="../../web/css/table.css" />
<link rel="stylesheet" href="/getCssStyle?css=static/web/plugins/layui2/css/layui.css" />
<link rel="stylesheet" href="/getCssStyle?css=static/web/plugins/layui/css/layui.css" media="all" />
<link rel="stylesheet" href="../../web/css/public.css" media="all">
<link rel="stylesheet" href="../../web/css/zhengls.css" /> 
<style>
.select_sty .layui-unselect.layui-form-select{float:left;width:82%;}
.workword{
word-wrap : break-word;
}
</style>

</head> 
<body> 
	<input type="hidden" name="${_csrf.parameterName}" id="${_csrf.parameterName}" value="${_csrf.token}" />
	<div class="layui-tab layui-tab-brief m_t0" lay-filter="docDemoTabBrief" style="margin-bottom:50px;">
		<ul class="layui-tab-title">
		    <li class="layui-this" id="tapone"><@a code="120201" href="javascript:void(0)" text="内部会议管理"/></li>
		    <li id="taptwo"><@a code="120202" href="javascript:void(0)" text="会议草稿箱"/></li>
		    <li id="tapthree"><@a code="120203" href="javascript:void(0)" text="新增内部会议"/></li>
		</ul>
		<div class="layui-tab-content">
		  	<div  class="layui-tab-item layui-show content_sel" id="tapGoone">
		  		<div class="">
		  		<blockquote class="layui-elem-quote" style="padding:5px;text-align: right;">
					<form class="layui-form" action="">
						<div>
							<div class="layui-input-inline">
								<input type="text" name="searchKey" id="searchKey" lay-verify="length20"  maxlength="20" placeholder="请输入议题或主持人" autocomplete="off" class="layui-input"
									style="height: 30px; line-height: 30px;">
							</div>
							<span lay-submit=""><@a code="120204" href="javascript:void(0)" class="layui-btn layui-btn-small" id="" onclick="loadData(1)" iclass="layui-icon"
								 icon="&#xe615;" text="查询"/></span>
							<span lay-submit=""><@a code="120205" href="javascript:void(0)" class="layui-btn layui-btn-small" id="" onclick="search_h()" text="高级搜索"/></span>								 
						</div>
				<!-- 	    <div class="layui-input-inline">
						  	<span><a class="layui-btn layui-btn-small" onclick="onclick="showDeletes()"><i class="layui-icon">&#xe640;</i>删除</a></span>
						</div> -->
					</form>
				</blockquote>
					<form class="layui-form sear" action="" style="display:none;">
					<div>
						<!-- <div class="layui-input-inline m_r10" >
						 <span>议题</span>
						</div>
						<div class="layui-input-inline m_r20">
							<input type="text" class="inp_w120px" name="" id="meetingTitle-search" style="width:180px;" lay-verify="length50" maxlength="50">
						</div> -->
						<!-- <div class="layui-input-inline m_r10">
						 <span>主持人</span>
						</div>
						<div class="layui-input-inline m_r20">
							<input type="text" class="inp_w120px" name="" id="meetingHost-search" lay-verify="length20"  maxlength="50">
						</div> -->
						<div class="layui-input-inline m_r10">
						 	<span>会议室</span>
						</div>
						<div class="layui-input-inline m_r20">
					      		<select name="meetingRoomId" lay-verify="" style="width:150px;height:32px;" id="meetingRoomId-search">
							        <option value=""></option>
					      		</select>
					   	</div>
					   	<div class="layui-input-inline m_r10">
						 	<span>会议情况</span>
						</div>
						<div class="layui-input-inline m_r20">
					      		<select name="meetingSituation" lay-verify="" style="width:150px;height:32px;" id="meetingSituation-search">
									<option value="">请选择</option>
									<option value="1">未完成</option>
									<option value="2">已完成</option>
							        <option value="3">已取消</option>
					      		</select>
					   	</div>
					   	<div class="layui-input-inline m_r10">
						 <span>会议时间</span>
						</div>
						<div class="layui-input-inline m_r20">
							 <input type="text" class="inp_date" name="" id="startTime-search" lay-verify="specailChar|textLength10">
						</div>
						<div class="layui-input-inline m_r10">
						 <span>至</span>
						</div>
						<div class="layui-input-inline m_r20">
							  <input type="text" class="inp_date" name="" id="endTime-search" lay-verify="specailChar|textLength10">
						</div> 
						<span lay-submit=""><a class="layui-btn layui-btn-small"  onclick="loadData(2)" style="float:right;"><i class="layui-icon">&#xe615;</i>查询</a></span>
				   </div>
				   <!-- <div class="m_t10">
						
				    </div> -->
					</form>
<!-- 					<form class="layui-form m_t30" action="">
						  <a class="btn_blue m_r20" onclick="">起草内部会议</a>
					</form> -->
					<div class="layui-form">
						<table class="layui-table admin-table">
							<colgroup>
								<col width="6%">
								<col width="18%">
								<col width="15%">
								<col width="14%">
								<col width="12%">
								<col width="12%">
								<col width="10%">
								<col width="8%">
								<col width="8%">
							</colgroup>
							<thead>
								<tr>
									<th style="display: none;">用户ID</th>
									<th>序号</th>
									<th>会议议题</th>
									<th>主持人</th>
									<th>会议室</th>
									<th>会议开始时间</th>
									<th>会议结束时间</th>
									<th>会议情况</th>
									<th>联系人</th>
									<th>创建人</th>
								</tr>
							</thead>
					<tbody id="paging-data">
					<script id="paging-script" type="text/html">
					{{each records value index}}
						<tr>
							<td style="display: none;">{{value.id}}</td>
							<td>{{(current-1)*size+index+1}}</td>
							<td class="table_link" onclick="detail('{{value.id}}','0')" style="cursor:pointer;" title="{{value.meetingTitle}}">{{value.meetingTitle}}</td>
							<td title="{{value.meetingHost}}">{{value.meetingHost}}</td>
							<td style="cursor:pointer;">{{value.meetingRoomName}}</td>
							<td title="{{value.beginDate}}">{{value.beginDate}}</td>
							<td title="{{value.endDate}}">{{value.endDate}}</td>
							<td>{{value.meetingSituation}}</td>
							<td>{{value.contacts}}</td>
							<td>{{value.createFullName}}</td>
						</tr>
					{{/each}}
					</script>
					</tbody>
					</table>
					</div>
					<div class="admin-table-page" style="border-width: 0px; z-index: 0;">
						<div id="paging-footer" class="page" style="background-color: white; text-align: center;"></div>
					</div>
		  		</div>
		  	</div>
		    <div class="layui-tab-item content_sel" id="tapGotwo">
		     <!--  内部会议草稿箱-->
		    	<div class="">
		    		<blockquote class="layui-elem-quote" style="padding:5px;">
					<form class="layui-form" action="">
						<div style="float:right;">
							<div class="layui-input-inline m_r10">
							 	<span>会议室</span>
							</div>
							<div class="layui-input-inline m_r20">
						      		<select name="meetingRoomId" lay-verify="" style="width:150px;height:32px;" id="meetingRoomId-draft-search">
								        <option value=""></option>
						      		</select>
						   	</div>
						   <!-- 	<div class="layui-input-inline m_r10">
							 	<span>会议地址</span>
							</div>
							<div class="layui-input-inline m_r20">
						      		<select name="city"  style="width:150px;height:32px;">
								        <option value=""></option>
						      		</select>
						   	</div> -->
							<div class="layui-input-inline">
								<input type="text" name="searchKey" id="searchKey_" lay-verify="length20" maxlength="20" placeholder="请输入议题或主持人" autocomplete="off" class="layui-input"
									style="height: 30px; line-height: 30px;">
							</div>
							<span lay-submit=""><@a code="120206" href="javascript:void(0)" class="layui-btn layui-btn-small" id="" onclick="loadDraftData(1)" iclass="layui-icon"
								 icon="&#xe615;" text="查询"/></span>
						    <!-- <span><a class="layui-btn layui-btn-small" onclick="search_h()">高级搜索</a></span> -->
						</div>
				 	    <div class="layui-input-inline">
							<span lay-submit=""><@a code="120207" href="javascript:void(0)" class="layui-btn layui-btn-small" id="" onclick="deleteBatchDraft()" iclass="layui-icon"
								 icon="&#xe640;" text="删除"/></span>				 	    
						</div> 
					</form> 
					</blockquote>
<!-- 					<form class="layui-form" action="">
					<div>
						<div class="layui-input-inline m_r10" >
						 <span>议题</span>
						</div>
						<div class="layui-input-inline m_r20">
							<input type="text" class="inp_w120px" name="" id="" style="width:180px;">
						</div>
						<div class="layui-input-inline m_r10">
						 <span>主持人</span>
						</div>
						<div class="layui-input-inline m_r20">
							<input type="text" class="inp_w120px" name="" id="">
						</div>
						<div class="layui-input-inline m_r10">
						 	<span>会议室</span>
						</div>
						<div class="layui-input-inline m_r20">
					      		<select name="city" lay-verify="required" style="width:150px;height:32px;">
							        <option value=""></option>
							        <option value="0">会议室1</option>
							        <option value="1">会议室2</option>
							        <option value="2">会议室3</option>
					      		</select>
					   	</div>
					   	<div class="layui-input-inline m_r10">
						 	<span>会议地址</span>
						</div>
						<div class="layui-input-inline m_r20">
					      		<select name="city" lay-verify="required" style="width:150px;height:32px;">
							        <option value=""></option>
							        <option value="0">会议地址1</option>
							        <option value="1">会议地址2</option>
							        <option value="2">会议地址3</option>
					      		</select>
					   	</div>
						<span><a class="btn_search_blue" id="" onclick="loadData()" style="float:right;">查询</a></span>
				    </div>
					</form> -->
				<!-- 	<form class="layui-form m_t30" action="">
						  <a class="btn_blue m_r20" onclick="">删除</a>
					</form> -->
					<div class="layui-form">
						<table class="layui-table admin-table">
						   <colgroup>
								<col width="4%">
								<col width="6%">
								<col width="17%">
								<col width="15%">
								<col width="15%">
								<col width="12%">
								<col width="12%">
								<col width="8%">
								<col width="11%">
							</colgroup>
							<thead>
								<tr>
									<th style="width: 20px;"><input type="checkbox" id="paging_check-all" lay-skin="primary" lay-filter="paging_check-all"></th>
									<th style="display: none;">用户ID</th>
									<th>序号</th>
									<th>会议议题</th>
									<th>主持人</th>
									<th>会议室</th>
									<th>会议开始时间</th>
									<th>会议结束时间</th>
									<th>创建人</th>
									<th>操作</th>
								</tr>
							</thead>
					<tbody id="paging2-data">
					<script id="paging2-script" type="text/html">
					{{each records value index}}
						<tr>
							<td onclick="defalt_td(event)"><input type="checkbox"  class="check-id moreInput"  lay-skin="primary"   id="{{value.id}}"></td>
							<td style="display: none;">{{value.id}}</td>
							<td>{{(current-1)*size+index+1}}</td>
							<td class="table_link"  onclick="detail('{{value.id}}','1')" style="cursor:pointer;" title="{{value.meetingTitle}}">{{value.meetingTitle}}</td>
							<td>{{value.meetingHost}}</td>
							<td onclick="detail('{{value.id}}','1')" style="cursor:pointer;" title="{{value.meetingRoomName}}">{{value.meetingRoomName}}</td>
							<td title="{{value.beginDate}}">{{value.beginDate}}</td>
							<td title="{{value.endDate}}">{{value.endDate}}</td>
							<td>{{value.createFullName}}</td>
							<td onclick="defalt_td(event)">
								<@a code="120208" href="javascript:void(0)" class="table_btn" id="show-edit" onclick="edit('{{value.id}}',this)" text="编辑"/>
								<@a code="120209" href="javascript:void(0)" class="table_btn" id="show-delete" onclick="showDelete('{{value.id}}',this)" text="删除"/>
							</td>
						</tr>
					{{/each}}
					</script>
					</tbody>
					</table>
					</div>
					<div class="admin-table-page" style="border-width: 0px; z-index: 0;">
						<div id="paging2-footer" class="page" style="background-color: white; text-align: center;"></div>
					</div>
		  		</div>
		    </div>
		    <div class="layui-tab-item" id="tapGothree">
			    <!-- 新建内部会议-->
				<div class="" id="win-newinside-object">
					<form class="layui-form layui-form-pane" id="new-object-form">
						<input type="hidden"  id="noclear" name="${_csrf.parameterName}" value="${_csrf.token}" />
						<input type="hidden" name="status" id="status" value=""/>
						
						<!-- 附件 -->
						<div id="filealea_add">

						</div>
						<div class="layui-form-item">
							<label class="layui-form-label">会议标题</label>
							<div class="layui-input-block">
								<input type="text" name="meetingTitle"  lay-verify="required" maxlength="50" autocomplete="off" placeholder="会议标题" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item">
							<label class="layui-form-label">主持人</label>
							<div class="layui-input-block">
								<input type="text" name="meetingHost"  lay-verify="required" maxlength="20" autocomplete="off" placeholder="主持人" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item">
							<label class="layui-form-label">联系人</label>
							<div class="layui-input-block">
								<input type="text" name="contacts"  lay-verify="required" maxlength="50" autocomplete="off" placeholder="联系人" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item">
						    <label class="layui-form-label">会议室</label>
						    <div class="layui-input-block select_sty">
						        <select name="meetingRoomId" lay-verify="required" id="meetingRoomId-add" lay-filter="meetingRoomId">
						        </select>
								<input type="hidden" name="meetingRoomName" id="meetingRoomName-add"/>
								<a href="#" style="float:right;color:#339bf1;" onclick="checkmeeroom()">查看会议室使用情况</a>
						    </div>
					 	</div>
					 	<!-- <div class="layui-form-item">
					 		<a href="#" style="float:right;color:#339bf1;" onclick="checkmeeroom()">查看会议室使用情况</a>
					 	</div> -->
					 	<div class="layui-form-item">
							<label class="layui-form-label">会议地址</label>
							<div class="layui-input-block">
								<input type="text" name="address"  lay-verify="required" maxlength="100" autocomplete="off" placeholder="填写地址" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item">
							<label class="layui-form-label">参会人员</label>
							<div class="layui-input-block">
								<input type="hidden" style="width:81%;float:left;" name="partyMemeberNames" id="partyMemeberNames-add" autocomplete="off" placeholder="参会人员" class="layui-input" readonly="readonly">
								<div type="text" style="width:81%;float:left;" name="partyMemeberNames-addDiv" id="partyMemeberNames-addDiv" lay-verify="" autocomplete="off" placeholder="公告对象" class="newgg reset1" readonly="readonly"></div>
								<input type="hidden" name="partyMemebersId" id="partyMemebersId-add" value=""/>
								<a class="btn_blue2 btn_blue2one" style="float:right;">人员选择</a>
							</div>
						</div>
						<div class="layui-form-item layui-form-text">
							<label class="layui-form-label">外部出席单位/人员</label>
							<div class="layui-input-block">
								 <textarea name="attendances"  placeholder="请输入内容"   maxlength="1000" class="layui-textarea"></textarea>
							</div>
						</div>
						<div class="layui-form-item">
							<label class="layui-form-label">开始时间</label>
							<div class="layui-input-block">
								<input type="text" name="beginTime" id="startTime1"  readonly lay-verify="required" autocomplete="off" placeholder="会议开始时间" class="layui-input startTime">
							</div>
						</div> 
						<div class="layui-form-item">
							<label class="layui-form-label" onclick="aa()">结束时间</label>
							<div class="layui-input-block">
								<input type="text" name="endTime" id="endTime1"  readonly lay-verify="required" autocomplete="off" placeholder="会议结束时间" class="layui-input endTime">
							</div>
						</div>   
						<div class="layui-form-item layui-form-text">
							<label class="layui-form-label">会议内容</label>
							<div class="layui-input-block">
								 <textarea name="meetingContent"  placeholder="请输入内容" lay-verify="required"  maxlength="1000" class="layui-textarea"></textarea>
							</div>
						</div> 
						<div class="layui-form-item">
						    <label class="layui-form-label">提醒方式</label>
						    <div class="layui-input-block">
								<input type="hidden" name="isWarnMsg"  id="isWarn-Msg" title="短信" lay-skin="primary" value="" >
								<input type="hidden" name="isWarnMail" id="isWarn-Mail"title="邮件" lay-skin="primary" value="">
								<input type="hidden" name="isWarnOnline" id="isWarn-Online" title="在线" lay-skin="primary" value="">

						      	<input type="checkbox" lay-filter="isWarnMsg" class="clearbox" name="isWarnMsg-add" title="短信提醒" lay-skin="primary" value="" >
						      	<input type="checkbox" lay-filter="isWarnMail" class="clearbox" name="isWarnMail-add" title="邮件提醒" lay-skin="primary" value="">
						      	<input type="checkbox" lay-filter="isWarnOnline" class="clearbox" name="isWarnOnline-add" title="消息提醒" lay-skin="primary" value="">
						        <span style="    position: relative; top: 3px; color: #B5B5B5;">(系统将会在会议开始前一天的16:20再次提醒参会人员)</span>
						    </div>
						</div>
						<div class="layui-form-item">
							<label class="layui-form-label">上传附件</label>
							<div class="layui-input-block">
								<div class="layui-upload">
			 					   <div class="layui-upload-drag drag" id="test10">
										  <i class="layui-icon"></i>
										  <p>点击上传，或将文件拖拽到此处</p>
								   </div>
			 					  <a class="layui-btn bigin_upload" id="testListAction">
										<i class="layui-icon">&#xe62f;</i> 开始上传
						  		   </a>
								   <div class="layui-upload-list">
								       <table class="layui-table">
									      	<tbody id="demoList_add">
											<script   id="artt1"  type="text/html">
												{{each filelist value index}}
												<tr >
													<td>{{value.orgnlFileName}}</td>
													<td>{{value.fileSize}}kb</td>
													<td><span style="color: #5FB878;">上传成功</span></td>
													<td>
														<a style="color:#339bf1;" index="{{index}}" onclick="aleafile('{{value.id}}',this,{{index}})">删除</a>
													</td>
												</tr>
												{{/each}}
											</script>
											</tbody>
								       </table>
								   </div>
								</div> 
							</div>
						</div>
						<div class=" btn_fixed">
							<div style="float: right;">
								<button class="layui-btn" lay-submit="" lay-filter="form-add-submit">
									<i class="fa fa-save"></i> 提交
								</button>
								<button  class="layui-btn layui-btn-primary" lay-submit="" lay-filter="form-save-submit">
									<li class="fa fa-eraser"></li> 保存
								</button>
							</div>
						</div>
					</form>
				</div>
		    </div>
		</div>
	</div>  
	<!-- 会议详情 -->
	<div class="admin-main" style="display: none; z-index: 19940200;margin-bottom:60px;" id="win-detail-object">
		<div id="win-newsms-object">
			<form class="layui-form" id="detail-object-form">
				<input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
				<!-- <div class="p_t10 ">
					<span class="e6ed " style="width:100px;">会议标题：</span>
					<span id="meetingTitle"></span>
			    </div> -->
			    <!-- 标题 -->
				<div class="" style="text-align: center;">
					 <span id="meetingTitle" style="font-size:16px;font-weight: bold;word-wrap:break-word"></span>
				</div>
				
			    <div class="p_t10">
					<span class="e6ed" style="width:100px;">主持人：</span>
					<span id="meetingHost"></span>
			    </div>
			     <div class="p_t10  ">
					<span class="e6ed" style="width:100px;">联系人：</span>
					<span id="contacts"></span>
			    </div>
			    <div class="p_t10 ">
					<span class="e6ed" style="width:100px;">会议室：</span>
					<span id="meetingRoomName"></span>
			    </div>
				<div class="p_t10">
					<span class="e6ed" style="width:100px;">会议地址：</span>
					<span id="address"></span>
			    </div>
			    <div class="p_t10">
					<span class="e6ed l" style="width:100px;">参会人员：</span>
					<div id="partyMemeberNames" class="l" style="word-wrap: break-word; width: 85%;margin-left: 4px;"></div>
			    </div>
			     <div class="p_t10  cl">
					<span class="e6ed l" style="width:100px;">外部出席单位&nbsp;/&nbsp;人员：</span>
					<div id="attendances" class="l" style="word-wrap: break-word; width: 85%;margin-top: 19px;margin-left: 4px;"></div>
			    </div>
			    <div class="p_t10 cl">
					<span class="e6ed" style="width:100px;">会议时间：</span>
					<span id="beginTime"></span>
					<span class="e6ed m_r10" style="width:20px;">至</span>
					<span id="endTime"></span>
			    </div>
			    <!-- <div class="p_t10">
					<span class="e6ed" style="width:100px;">结束时间：</span>
					<span id="endTime"></span>
			    </div> -->
			    <!-- <div class="p_t10">
					<span class="e6ed" style="width:100px;">会议内容：</span>
					<span id="meetingContent"></span>
			    </div> -->
  				<!-- 会议内容 -->
                <div class="outindss" style="clear:both;" id="mailContent">
				  <p id="meetingContent" style="word-wrap: break-word;" class="heidf line_h_26px"></p>
				</div>
				 
				<!-- <div class="p_t10 ">
				    <span class="e6ed" style="width:100px;">提醒方式：</span>
				    <span>
				      <span id="isWarnMsg-add" style="display:none;display:inline-block">短信提醒;</span>
				      <span id="isWarnMail-add" style="display:none;display:inline-block">邮件提醒;</span>
				      <span id="isWarnOnline-add" style="display:none;display:inline-block">短信提醒;</span>
				    </span>
				</div> -->
		    	<div class="p_t10 cl" >
					<span  class="e6ed l" style="width: 100px;">附件：</span> 
				<div class="">
				      <table class="layui-table" style="width: 50%;margin-top: 0px;border: none;">
				         <colgroup>
						    <col width="60%">
						    <col width="20%">
						    <col width="20%">
						  </colgroup>
					      	<tbody id="demoList">
							<script   id="artt_detail"  type="text/html">
								{{each filelist value index}}
                                    <tr>
                   					   <td style="border:none"><span style="margin-right:20px;">{{value.orgnlFileName}}</span></td>
                                       <td style="border:none"><span style="margin-right:20px;">{{value.fileSize}}kb</span></td>
                   					   <td style="border:none"><a onclick="" style="color:#339bf1;cursor:pointer">下载</a></td>
                                    </tr>
	              				 {{/each}}
							</script>
							</tbody>
				       </table>
				    </div>
				</div>
				<div class="btn_fixed">
				<a href="javascript:void(0)" class="layui-btn layui-btn-primary" onclick="layer.closeAll();"><i class="fa fa-backward"></i> 返回</a>
			   </div>
			  </form>
			 </div>
		</div>
	<!-- 编辑内部会议-->
	<div class="admin-main" id="win-editinside-object" style="display: none; z-index: 19940200;margin-bottom:60px;">
		<form class="layui-form layui-form-pane" id="edit-object-form">
			<input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
			<input type="hidden" name="id" id="id-edit" value=""/>
			<input type="hidden" name="id" id="id-edit" value=""/>
			<input type="hidden" name="status" id="status" value=""/>
			<!-- 附件 -->
			<div id="filealea_edit">

			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">会议标题</label>
				<div class="layui-input-block">
					<input type="text" name="meetingTitle" id="meetingTitle-edit"  lay-verify="required" maxlength="50" autocomplete="off" placeholder="会议标题" class="layui-input">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">主持人</label>
				<div class="layui-input-block">
					<input type="text" name="meetingHost" id="meetingHost-edit" lay-verify="required" maxlength="20" autocomplete="off" placeholder="主持人" class="layui-input">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">联系人</label>
				<div class="layui-input-block">
					<input type="text" name="contacts" id="contacts-edit" lay-verify="required"  maxlength="50" autocomplete="off" placeholder="联系人" class="layui-input">
				</div>
			</div>
			<div class="layui-form-item select_sty">
				<label class="layui-form-label">会议室</label>
				<div class="layui-input-block">
					<select name="meetingRoomId" lay-verify="required" id="meetingRoomId-edit" lay-filter="meetingRoomId">
					</select>
					<input type="hidden" name="meetingRoomName" id="meetingRoomName-edit"/>
					<a href="#" style="float:right;color:#339bf1;" onclick="checkmeeroom()">查看会议室使用情况</a>
				</div>
			</div>
			<!-- <div class="layui-form-item">
				<a href="#" style="float:right;color:#339bf1;">查看会议室使用情况</a>
			</div> -->
			<div class="layui-form-item">
				<label class="layui-form-label">会议地址</label>
				<div class="layui-input-block">
					<input type="text" name="address" id="address-edit"  lay-verify="required"  maxlength="100" autocomplete="off" placeholder="填写地址" class="layui-input">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">参会人员</label>
				<div class="layui-input-block">
					<input type="hidden" style="width:81%;float:left;" name="partyMemeberNames" id="partyMemeberNames-edit" lay-verify="" autocomplete="off" placeholder="参会人员" class="layui-input" readonly="readonly">
					<div type="text" style="width:81%;float:left;" name="partyMemeberNames-edit" id="partyMemeberNames-editDiv" lay-verify="" autocomplete="off" placeholder="公告对象" class="newgg reset1" readonly="readonly"></div>
					<input type="hidden" name="partyMemebersId" id="partyMemebersId-edit" value=""/>
					<a class="btn_blue2 btn_blue2two" style="float:right;" >人员选择</a>
				</div>
			</div>
			<div class="layui-form-item layui-form-text">
				<label class="layui-form-label">外部出席单位/人员</label>
				<div class="layui-input-block">
					<textarea name="attendances" id="attendances-edit" placeholder="请输入内容"  maxlength="1000" class="layui-textarea"></textarea>
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">开始时间</label>
				<div class="layui-input-block">
					<input type="text" name="beginTime" id="beginTime-edit"  lay-verify="required"  readonly autocomplete="off" placeholder="会议开始时间" class="layui-input startTime">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">结束时间</label>
				<div class="layui-input-block">
					<input type="text" name="endTime" id="endTime-edit"  lay-verify="required"  readonly autocomplete="off" placeholder="会议结束时间" class="layui-input endTime">
				</div>
			</div>
			<div class="layui-form-item layui-form-text">
				<label class="layui-form-label">会议内容</label>
				<div class="layui-input-block">
					<textarea name="meetingContent"  lay-verify="required"  id="meetingContent-edit" placeholder="请输入内容"   maxlength="1000" class="layui-textarea"></textarea>
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">提醒方式</label>
				<div class="layui-input-block">
					<input type="hidden" name="isWarnMsg"  id="iswarn-msg-msg" title="短信" lay-skin="primary" value="" >
					<input type="hidden" name="isWarnMail" id="isWarn-mail-msg"title="邮件" lay-skin="primary" value="">
					<input type="hidden" name="isWarnOnline" id="isWarn-online-msg" title="在线" lay-skin="primary" value="">

					<input type="checkbox" lay-filter="isWarnMsg" id="isWarnMsg-edit" title="短信提醒" lay-skin="primary" value="" >
					<input type="checkbox" lay-filter="isWarnMail" id="isWarnMail-edit" title="邮件提醒" lay-skin="primary" value="">
					<input type="checkbox" lay-filter="isWarnOnline" id="isWarnOnline-edit" title="消息提醒" lay-skin="primary" value="">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">上传附件</label>
				<div class="layui-input-block">
					<div class="layui-upload">
						<div class="layui-upload-drag drag" id="test11">
							<i class="layui-icon"></i>
							<p>点击上传，或将文件拖拽到此处</p>
						</div>
						<a class="layui-btn bigin_upload" id="testListAction_edit">
							<i class="layui-icon">&#xe62f;</i> 开始上传
						</a>
						<div class="layui-upload-list">
							<table class="layui-table">
								<tbody id="demoList_edit">
								<script   id="artt_edit"  type="text/html">
									{{each filelist value index}}
									<tr>
										<td>{{value.orgnlFileName}}</td>
										<td>{{value.fileSize}}kb</td>
										<td><span style="color: #5FB878;">上传成功</span></td>
										<td>
											<a style="color:#339bf1;cursor:pointer" index="{{index}}"  onclick="aleafile('{{value.id}}',this,{{index}})">删除</a>
										</td>
									</tr>
									{{/each}}
								</script>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class=" btn_fixed">
				<a href="javascript:void(0)" class="layui-btn layui-btn-primary" onclick="layer.closeAll();"><i class="fa fa-backward"></i> 返回</a>
				<div style="float: right;">
				    <button class="layui-btn" lay-submit="" lay-filter="form-edit-add">
						<li class="fa fa-eraser"></li> 提交
					</button>
					<button class="layui-btn layui-btn-primary" lay-submit="" lay-filter="form-edit-submit">
						<i class="fa fa-save"></i> 保存
					</button>
					
				</div>
			</div>
		</form>
	</div>
	<!-- 人员选择树 -->
	<div style="display: none;z-index: 19940200;" id="win-personal-object">
		<div class="search_h">
			<input id="peopelSel" class="tree_search1 reset" type="text" value="" placeholder="搜索">
			<a class="layui-btn layui-btn-small" id="" onclick="searchNodes()"><i class="layui-icon">&#xe615;</i>搜索</a>
			<a class="layui-btn layui-btn-small layui-btn-primary" style="margin-left:2px;" type="reset" onclick="reset_tree()"><li class="fa fa-eraser"></li> 重置</a>
			<label type="text"  id="resultKey" class="form-control">  
                <div>  
                    <a id="clickUp" class="tree_up" onclick="clickUp()"><i class="layui-icon">&#xe619;</i></a>  
                    <a id="clickDown" class="tree_down" onclick="clickDown()"><i class="layui-icon">&#xe61a;</i></a>  
                </div>  
                <label id="number" class="tree_number"></label>  
            </label>  
        </div>
        <div class="tree_h">
        	<ul id="treeDemo" class="ztree treeDemo1" name="treeDemo" style="display:block"></ul>
        </div>
        <div class="sure_h">
		    <a class="layui-btn layui-btn-small sure_s"><li class="fa fa-save"></li> 确定</a>
		</div>
	</div>
	<!-- 查看会议室试用详情 -->
	<div class="admin-main" id="win-checkroom-object" style="display: none; z-index: 19940200;">
		<form class="layui-form layui-form-pane" id="checkroom-object-form">
			<input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
			<!-- tab中tab -->
				<div class="layui-tab">
					<ul class="layui-tab-title">
						<li class="layui-this" id="thisWeek">本周</li>
						<li id="thisMonth">本月</li>
					</ul>
					<div class="layui-tab-content" style="height: 100px; padding: 0;">
						<div class="layui-tab-item layui-show">
							<!--本周-->
							<div class="layui-form">
						        
								<table class="layui-table admin-table">
								
									<thead>
										<tr id="headone1">

										</tr>
									</thead>
									<tbody class="bufffa1">
										<tr id="headTwo1">

										</tr>
									</tbody>
									<tbody id="paging2-data">
										<script id="paging2-script" type="text/html">
							{{each records value index}}

							<tr >
								<td style="display: none;">{{value.id}}</td>
								<td>{{value.}}</td>
								<td>{{value.}}</td>
								<td>{{value.}}</td>
								<td>{{value.}}</td>
								<td>{{value.}}</td>
								<td>{{value.}}</td>
								<td>{{value.}}</td>
								<td>{{value.}}</td>
								<td>{{value.}}</td>
							</tr>
							{{/each}}
						</script>
									</tbody>
								</table>
							</div>
							<div class="admin-table-page"
								style="border-width: 0px; z-index: 0;">
								<div id="paging2-footer" class="page"
									style="background-color: white; text-align: center;"></div>
							</div>
						</div>
						<div class="layui-tab-item" style="height:500px;overflow-y:auto;">
							<!--本月-->
							<div class="layui-form">
								<table class="layui-table admin-table">
								   <colgroup>
										<col width="8%">
										<col width="8%">
								   </colgroup>
									<thead>
										<tr id="headone2">

										</tr>
									</thead >
									<tbody class="bufffa2">
										<tr id="headTwo2">

										</tr>
									</tbody>
									<tbody id="paging3-data">
										<script id="paging3-script" type="text/html">
							{{each records value index}}
							<tr >
								<td style="display: none;">{{value.id}}</td>
								<td>{{value.}}</td>
								<td>{{value.}}</td>
								<td>{{value.}}</td>
								<td>{{value.}}</td>
								<td>{{value.}}</td>
								<td>{{value.}}</td>
								<td>{{value.}}</td>
								<td>
									<@a code="000103" href="javascript:void(0)" class="table_btn" id="show-edit" onclick="edit('{{value.id}}')" text="编辑"/>
									<@a code="000105" href="javascript:void(0)" class="table_btn" id="show-delete" onclick="showDelete('{{value.id}}',this)" text="删除"/>
								</td>
							</tr>
							{{/each}}
						</script>
									</tbody>
								</table>
							</div>
							<div class="admin-table-page"
								style="border-width: 0px; z-index: 0;">
								<div id="paging3-footer" class="page"
									style="background-color: white; text-align: center;"></div>
							</div>
						</div>
					</div>
					
		
		</form>
	</div>
	
	
	<script type="text/javascript" src="../../web/plugins/layui2/layui.js"></script>
	<script type="text/javascript" src="../../web/plugins/layui/lay/modules/laypage.js"></script>
	<script type="text/javascript" src="../../web/js/template-web.js"></script>
	<script type="text/javascript" src="../../web/js/jquery.js"></script>
	<script type="text/javascript" src="../../web/js/tool_upload.js"></script>
    <script type="text/javascript" src="../../web/js/jquery.ztree.all.min.js"></script>
	<script type="text/javascript" src="../../web/js/laydate/laydate.js"></script>
	<script>
	     var tipsnum=0;//会议tips显示定位id;
	     var meeType;//会议被占用 区别是新增的还是编辑提交的
		//时间控件
	 	//tool.timeset('#startTime','#endTime');
	 	//tool.dateTime('#startTime1','#endTime1','YYYY-MM-DD hh:mm',true);
	 	tool.timeParse('#startTime1');
	 	tool.timeParse('#endTime1');
	 	tool.timeParse('#beginTime-edit');
	 	tool.timeParse('#endTime-edit');
        //tool.dateTime('#beginTime-edit','#endTime-edit','YYYY-MM-DD hh:mm',true);
        tool.dateTime('#startTime-search','#endTime-search','YYYY-MM-DD',false);
		//定义layui
		var pform;
        var arr=[];//放路径
        var nameArr=[];//放本地文件名
        var isCommitted = false;//表单是否已经提交标识，默认为false
		layui.use(['form','element'], function() {
			pform = layui.form;
            var element=layui.element;
            element.on('tab(docDemoTabBrief)', function(data){
    			 arr=[];
    			 nameArr=[];
    		  });
            pform.verify({
                //限制输入的长度为200
                textLength200 : function(value) {
                    if (value.length>200) {
                        return "长度不能超过200个字符";
                    }
                },
                //限制输入的长度为100
                textLength100 : function(value) {
                    if (value.length>100) {
                        return "长度不能超过100个字符";
                    }
                },
                //限制输入的长度为10
                textLength10 : function(value) {
                    if (value.length>10) {
                        return "长度不能超过10个字符";
                    }
                },
                //限制输入的长度为10
                numberLength10 : function(value) {
                    if (value.length>10) {
                        return "数字不能超过10位";
                    }
                },
                //限制不能输入特殊10
                specailChar:function (value) {
                    if (new RegExp("[':;' \"\",\\[\\]——|‘；<>《》`：”“']").test(value)) {
                        return '不能输入特殊字符';
                    }
                },
				special:function(value){
					var pattern = new RegExp("[`~!@#$^&*()=|{}':',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，？]"); 
					if(pattern.test(value)){
					     return "不能输入特殊字符";
					} 
				},
                length20:function(value){
                	if(value.length>20){
                		return "长度不能超过20个字符"
                	}
                },
                length50:function(value){
                	if(value.length>50){
                		return "长度不能超过50个字符"
                	}
                }
                
            });



            //监听下拉
            pform.on('select(meetingRoomId)', function(data) {
               var meetingRoomName =  $("#meetingRoomId").find("option:selected").text();
               var meetingRoomIdAdd =  $("#meetingRoomId-add").find("option:selected").text();
               var meetingRoomIdEdit =  $("#meetingRoomId-edit").find("option:selected").text();
               $("#meetingRoomName-add").val(meetingRoomIdAdd);
               $("#meetingRoomName-edit").val(meetingRoomIdEdit);
            });
            //监听复选框
            pform.on('checkbox(isWarnMsg)', function(data) {
                if(data.elem.checked){
                    $("#isWarn-Msg").val(1);
                    $("#iswarn-msg-msg").val(1);
				}else{
                    $("#isWarn-Msg").val(0);
                    $("#iswarn-msg-msg").val(0);
				}
                pform.render();
            });
            //监听复选框
            pform.on('checkbox(isWarnMail)', function(data) {
                if(data.elem.checked){
                    $("#isWarn-Mail").val(1);
                    $("#isWarn-mail-msg").val(1);
                }else{
                    $("#isWarn-Mail").val(0);
                    $("#isWarn-mail-msg").val(0);
                }
                pform.render();
            });
            //监听复选框
            pform.on('checkbox(isWarnOnline)', function(data) {
                if(data.elem.checked){
                    $("#isWarn-Online").val(1);
                    $("#isWarn-online-msg").val(1);
                }else{
                    $("#isWarn-Online").val(0);
                    $("#isWarn-online-msg").val(0);
                }
                pform.render();
            });
            
            
            //监听新增内部会议提交
            pform.on('submit(form-add-submit)', function(data) {
            	 var a = jy('new-object-form');
            	  if(a==false){
            		  return false;
            	  }
            	 
            	 layer.confirm('确定提交吗 ?', {
                      icon: 3,
                      title: '提示'
                 },function(index){  
                if(isCommitted == false){
                	meeType=1;
                    isCommitted = true;
                    $("#filealea_add").empty();
                    var str = "";
                    if (arr.length > 0) {
                        for (var i = 0; i < arr.length; i++) {
                        	str += '<input type="hidden" name="resResourceList['+i+'].id" value="'+arr[i].res.id+'" />';
                        }
                        $("#filealea_add").append(str);
                    }
                    tool.post("/mee/meeInsideMeeting/add", $("#new-object-form").serialize(),postCallBackInfoAdd, false);
                   }
                })
                return false;
            });

            //监听新增内部会议保存
            pform.on('submit(form-save-submit)', function(data) {
            	var a = jy('new-object-form');
	          	  if(a==false){
	          		  return false;
	          	  }
                if(isCommitted == false){
                    isCommitted = true;
                    $("#filealea_add").empty();
                    var str = "";
                    if (arr.length > 0) {
                        for (var i = 0; i < arr.length; i++) {
                            str += '<input type="hidden" name="resResourceList['+i+'].id" value="'+arr[i].res.id+'" />';
                        }
                        $("#filealea_add").append(str);
                    }
                    tool.post("/mee/meeInsideMeetingDraft/add", $("#new-object-form").serialize(),postCallBackInfo, false);
                    return false;
                }
            });
            
            
            
            
            
            
            //编辑内部会议提交
            pform.on('submit(form-edit-add)', function(data) {
             var a = jy('edit-object-form');
           	  if(a==false){
           		  return false;
           	  }
	          	layer.confirm('确定提交吗 ?', {
	                icon: 3,
	                title: '提示'
	            }, function (index) {
	            if(isCommitted == false){
	            	meeType=2;
	            	isCommitted = true;	
					$("#filealea_edit").empty();
					//$("#edit-object-form").find("#id-edit").val("");
					var str = "";
					if (arr.length > 0) {
						for (var i = 0; i < arr.length; i++) {
							str += '<input type="hidden" name="resResourceList['+i+'].id" value="'+arr[i].res.id+'" />';
						}
						$("#filealea_edit").append(str);
					}
					tool.post("/mee/meeInsideMeeting/add", $("#edit-object-form").serialize(),postCallBackInfoAdd, false);
					
	             }
	            });
	          	return false;
              
            });

            //监听编辑内部会议保存
            pform.on('submit(form-edit-submit)', function(data) {
            	var a = jy('edit-object-form');
             	if(a==false){
             		  return false;
             	  }
                if(isCommitted == false){
                    isCommitted = true;
                    $("#filealea_edit").empty();
                    var str = "";
                    if (arr.length > 0) {
                        for (var i = 0; i < arr.length; i++) {
                        	str += '<input type="hidden" name="resResourceList['+i+'].id" value="'+arr[i].res.id+'" />';
                        }
                        $("#filealea_edit").append(str);
                    }
                    tool.post("/mee/meeInsideMeetingDraft/update", $("#edit-object-form").serialize(),postCallBackInfo, false);
                    return false;
                }
            });
            loadData();
            loadDraftData();
            $("#thisWeek").on("click",function () {
                loadCountData(1);
            });
            $("#thisMonth").on("click",function () {
                loadCountData(2);
            });
		});
         //校验
		function jy(father){
			/* 参会人员必填--校验 */
			var userMail =$("#"+father).find(".newgg").text();
		    if(userMail==""||userMail==undefined){
		       tool.error('参会人员不能为空');
			   return false;
			} 
		    //开始时间 结束时间对比校验
		     var start=Date.parse($("#"+father).find('.startTime').val());
	    	 var end =Date.parse($("#"+father).find(".endTime").val());
	    	 if(end<=start){
	    		 tool.error('结束时间要大于开始时间');
	    		 return false;
	    	 }else{
	    		 var todayStart =  $("#"+father).find('.startTime').val();
	    		 var todayEnd =  $("#"+father).find('.endTime').val();
	    		 todayStart=todayStart.substr(0,todayStart.length-6);
	    		 todayEnd=todayEnd.substr(0,todayEnd.length-6);
	    		 if(todayStart!=todayEnd){
	    			 tool.error("只能选择一天内的时间");
	    			 return false;
	    		 }
	    	 }
		    
	   }
        function loadCountData(index,meetingRoomId) {
            var param = new Object();
            param._csrf = $("#_csrf").val();
            if(index == 1){
                param.thisWeek = "1";
            }else{
                param.thisMonth = "1";
            }
            param.beginTime = $("#startTime").val();
            param.endTime = $("#endTime").val();
            param.searchKey = $("#searchKey").val();
            if(meetingRoomId){
                param.meetingRoomId = meetingRoomId;
            }
            tool.post("/mee/meeMeetingRoom/countlist", param, function (data) {
                if(null != data.mapList){
                    var count = 0;
                    var mapList = data.mapList[0];
                    var theadList = data.theadList;
                    for(var key  in mapList){//获得数据行
                        count++;
                    }

                    var strone = "";
                    $("#headTwo"+index).empty();
                    $("#headone"+index).empty();
                    $("#headTwo"+index).nextAll().remove();
                    //生成表头
                    for(var i=0;i<theadList.length;i++){
                        var datas=theadList[i];
                        strone+=' <th><p>'+datas+'</p></th>'
                    }
                    $("#headone"+index).append(strone);

                    //生成表格内容
                    var content="";
                    for(var k=0;k<count;k++){
                        content+='<tr class="xuanz  publicchoose">';

                        for(var m=0;m<theadList.length;m++){
                            if(m!=0 || m!=1){
                                content+='<td id='+theadList[m]+'></td>';
                            }
                        }
                        content+='</tr>';

                    }
                    $("#headTwo"+index).after(content);

                    var flag = 0;
                    $(".bufffa"+index).find(".xuanz").each(function(){
                        var thisObj = this;
                        var flag2 = 0;
                        for(var key in mapList){
                            if(flag == flag2){
                                var roomArr = [];
                                if(key != null){
                                	if(key.indexOf(",")>-1){
                                        roomArr = key.split(",");
                                    }
                                }
                                if(null != roomArr){
                                    $(thisObj).find("td").eq(0).text(roomArr[0]);
                                    $(thisObj).find("td").eq(0).attr("title",roomArr[0])
                                }
                                var count = 0;
                                for(var keys in mapList[key]){
                                	 tipsnum++
                                	 var tipsId= 'tipsId'+tipsnum;
                                    //for(var t in mapList[key][keys]){
                                    var ke= keys.replace(/\s+/g,"");
                                    count+=mapList[key][keys].length;
                                    for(var i = 0;i<mapList[key][keys].length;i++){
                                    	tipsId= tipsId+i;
                                        var obj = mapList[key][keys][i];
                                       
                                        //开始时间 obj.beginTime
                                        // 结束时间 obj.endTime
                                        // 主题  obj.meetingTitle
                                        // 主持人 obj.meetingHost
                                        obj.beginTime='开始时间：'+obj.beginTime;
										obj.endTime='结束时间：'+obj.endTime;
										obj.meetingTitle='会议主题：'+obj.meetingTitle;
										obj.meetingHost='&nbsp;&nbsp;&nbsp;主持人：'+obj.meetingHost;
										var title='<div class="workword">'+obj.beginTime+'</div>'+'<div class="workword">'+obj.endTime+'</div>'+'<div class="workword">'+obj.meetingTitle+'</div>'+'<div class="workword">'+obj.meetingHost+'</div>'
                                        $(thisObj).find("#"+ke).append("<div class='thisweek' style='margin-bottom: 5px;position: relative;' id='"+tipsId+"' tetl='"+title+"' onmouseenter='tipsMee(event,this)'></div>");
                                    }
                                    //}
                                    
                                }
                                $(thisObj).find("td").eq(1).text(count);
                            }
                            flag2++;
                        }
                        flag++;
                    });
                }
            }, false);
        }
        function tipsMee(event,myself){
    		var  id= $(myself).attr("id");
    		var  title= $(myself).attr("tetl");
    		layer.tips(title, '#'+id,{
    			 tips: [2, '#3595CC'],
   			     time: 3000
    		});
		}
         //提交回调 
        function postCallBackInfoAdd(retMsg){
        	isCommitted = false;
            if (retMsg.code == 0) {
                //提交后 再情况存放文件的数组 避免重复提交
                layer.alert(retMsg.message, {
                    title : "操作提示",
                    icon : 1,
                    closeBtn:0
                }, function(index) {
                	$("#tapone").attr("class","layui-this");
                    $("#taptwo").attr("class","");
                    $("#tapthree").attr("class","");
                    $("#tapGoone").addClass("layui-show");
                    $("#tapGotwo").removeClass("layui-show");
                    $("#tapGothree").removeClass("layui-show");
                    clearform()
                    layer.closeAll();
                    loadData();
                    loadCountData();
                    loadDraftData();
                    
                });
            } else if(retMsg.code ==2 ){ 
            	layer.confirm(retMsg.message, {
            		  icon: 3,
            		  closeBtn:0,
            		}, function(index){
            			if(meeType==1){
	                   		 $("#new-object-form").find("#status").val("1");
	                            tool.post("/mee/meeInsideMeeting/add", $("#new-object-form").serialize(),postCallBackInfoAdd, false);
	                   	  }else{
	                   		 $("#edit-object-form").find("#status").val("1"); 
	                   		 tool.post("/mee/meeInsideMeeting/add", $("#edit-object-form").serialize(),postCallBackInfoAdd, false);
	                   	  }
            			
            		});
                
            }else{
            	  tool.error(retMsg.message);
            }
        }
         
         //新增后清空内容函数
           function clearform(){
        	   laydate.reset();
        	    $("#new-object-form").find('#status').val("");
        	    $("#edit-object-form").find('#status').val("");
	        	$('#partyMemebersId-add').val("");
	   			$('#partyMemeberNames-add').val("");
	   			$('#partyMemebersId-edit').val("");
	   			$('#partyMemeberNames-edit').val("");
	   			$('#partyMemeberNames-addDiv').text("");
	   			$('#partyMemeberNames-editDiv').text("");
	   			$("#meetingRoomId-add").val("")
        	  arr=[];
 			  nameArr=[];
        	  $("#new-object-form").find(".layui-input").val("");
        	  $("#new-object-form").find(".layui-textarea").val("");
        	  $("#new-object-form").find(".clearbox").attr("checked",false);
        	  $("#new-object-form").find("#filealea_add").empty();
        	  $("#new-object-form").find("#demoList_add").find("tr").remove();
        	  pform.render();
        	 }
        //保存回调
        function postCallBackInfo(retMsg){
        	isCommitted = false;
            if (retMsg.code == 0) {
                //提交后 再情况存放文件的数组 避免重复提交
                layer.alert(retMsg.message, {
                    title : "操作提示",
                    icon : 1,
                    closeBtn:0
                }, function(index) {
                	$("#tapone").attr("class","");
                    $("#taptwo").attr("class","layui-this");
                    $("#tapthree").attr("class","");
                    $("#tapGoone").removeClass("layui-show");
                    $("#tapGotwo").addClass("layui-show");
                    $("#tapGothree").removeClass("layui-show");
                	clearform()
                    layer.closeAll();
                	var laypageBtn=$(pageBtn).parents(".admin-table").parent().next().find(".layui-laypage-btn");
                	if(laypageBtn.length>0){
                		laypageBtn.trigger("click");
                	}else{
                		loadDraftData();
                	}
                    
                });
            } else {
                tool.error(retMsg.message);
            }
        }

        //内部会议列表
        function loadData(type) {
            var param = new Object();
            param.container = "paging";
            param.url = "/mee/meeInsideMeeting/list";
            param._csrf = $("#_csrf").val();
            param.pageSize = 10;
            if(type==1){
            	param.searchKey = $("#searchKey").val();
            }else{
            	param.searchKey = $("#searchKey").val();
                //param.meetingTitle = $("#meetingTitle-search").val();
                //param.address = $("#address-search").val();
               // param.meetingHost = $("#meetingHost-search").val();
                param.meetingRoomId = $("#meetingRoomId-search").val();
    			param.meetingSituation = $("#meetingSituation-search").val();
    			param.startDate = $("#startTime-search").val();
    			param.endDate = $("#endTime-search").val();
            }
            tool.loadpage(param);
        }

        //内部会议草稿列表
        function loadDraftData() {
            var param = new Object();
            param.container = "paging2";
            param.url = "/mee/meeInsideMeetingDraft/list";
            param._csrf = $("#_csrf").val();
            param.pageSize = 10;
            param.searchKey = $("#searchKey_").val();
            param.meetingRoomId = $("#meetingRoomId-draft-search").val();
            param.address = $("#address-draft-search").val();
            tool.loadpage(param);
        }

        getMeeRoom();
        //分类下拉框数据加载
        function getMeeRoom(){
            var  param={
                _csrf:$("#_csrf").val()
            }
            tool.post("/mee/meeMeetingRoom/roomList",param,function(data){
                $("#meetingRoomId").empty();
                $("#meetingRoomId").append('<option value="">请选择</option>');
                $("#meetingRoomId-add").empty();
                $("#meetingRoomId-add").append('<option value="">请选择</option>');
                $("#meetingRoomId-edit").empty();
                $("#meetingRoomId-edit").append('<option value="">请选择</option>');
                $("#meetingRoomId-search").empty();
                $("#meetingRoomId-search").append('<option value="">请选择</option>');
                
                $("#meetingRoomId-draft-search").empty();
                $("#meetingRoomId-draft-search").append('<option value="">请选择</option>');
                var str="";
                for(var i=0;i<data.length;i++){
                    str+=' <option value="'+data[i].id+'">'+data[i].meetingRoomName+'</option>';
                }
                $("#meetingRoomId-add").append(str);
                $("#meetingRoomId-edit").append(str);
                $("#meetingRoomId-search").append(str);
                $("#meetingRoomId").append(str);
                
                
                $("#meetingRoomId-draft-search").append(str);
                //pform.render();
            },false)
        }
        
        
        $(".btn_blue2one").click(function(){
      	  tool.treeDemo("win-personal-object","treeDemo","partyMemebersId-add","partyMemeberNames-add","partyMemeberNames-addDiv");
      	  $("#number").html("");
        })
          $(".btn_blue2two").click(function(){
      	  tool.treeDemo("win-personal-object","treeDemo","partyMemebersId-edit","partyMemeberNames-edit","partyMemeberNames-editDiv");
      	  $("#number").html("");
        })
              //用按钮查询节点  
     /*    function searchNodes(){  
            var mytree = $.fn.zTree.getZTreeObj("treeDemo");  
            var keywords=$("#peopelSel").val();  
            var nodes = mytree.getNodesByParamFuzzy("name", keywords, null);  
            if (nodes.length>0) {  
                mytree.selectNode(nodes[0]);  
            }  
        }   */
      //重置树
		function reset_tree(){
			var mytree = $.fn.zTree.getZTreeObj("treeDemo");
		    //打开弹窗前重置节点以及关闭展开状态，避免叠加
			$('#partyMemebersId-add').val("");
			$('#partyMemeberNames-add').val("");
			$('#partyMemebersId-edit').val("");
			$('#partyMemeberNames-edit').val("");
			$('#partyMemeberNames-addDiv').text("");
			$('#partyMemeberNames-editDiv').text("");
			$('.reset').val("");
			$("#number").html("");
			mytree.checkAllNodes(false)
		    mytree.expandAll(false);
		}
    
        //新增上传
     
        tool.fileUpload("demoList_edit","test11","/res/file/upload","testListAction_edit","MEE_OUTSIDE_MEETING_DRAFT");
        tool.fileUpload("demoList_add","test10","/res/file/upload","testListAction","MEE_INSIDE_MEETING");

        //删除编辑里面的附件
        function aleafile(id,myself,index){
            layer.confirm('确定删除吗 ?', {
                icon: 3,
                title: '提示'
            }, function (index) {
                var retMsg = tool.deleteById("/res/resResource/delete", id);
                if (retMsg.code == 0) {
                    tool.success(retMsg.message);
                    $(myself).parent().parent().remove();
                    for(var i=0;i<arr.length;i++){
                        if(arr[i].index==index){
                            arr.splice(i,1)
                        }
                    }
                    for(var i=0;i<nameArr.length;i++){
                        if(nameArr[i].index==index){
                            nameArr.splice(i,1)
                        }
                    }
                } else {
                    tool.error(retMsg.message);
                }
            });
        }
         var indexMee
        //内部会议详情
        function detail(id,isDraft) {
        	
        	 indexMee= layer.open({
				  type: 2,
				  title:'',
				  closeBtn:0,
				  shade: 0.8, 
				  shadeClose: true,
				  content: 'meeInsideManagePageDetail.html?id='+id+'&isDraft='+isDraft
				});
			    pform.render();
				layer.full(indexMee);

        }
         var pageBtn;//锁定编辑后分页不跳到第一页
        //公共信息编辑
        function edit(id,myself) {
        	pageBtn=myself;
            getMeeRoom();
            var object =  tool.getById("/mee/meeInsideMeetingDraft/getById", id);
            var fileBack=object.resResourceList;
       		/* if(fileBack!=null){
				 for(var i=0;i<fileBack.length;i++){
					 arr.push({res:fileBack[i].attachPath,index:i})
	                 nameArr.push({fileName:fileBack[i].attachName,index:i,fileSize:fileBack[i].attachSize})
				 }
			} */
            var filelist={filelist:fileBack};
            $('#demoList_edit').html(template("artt_edit", filelist));
            
            //文件信息回填
		
            $("#partyMemeberNames-editDiv").text(object.partyMemeberNames)
            for ( var key in object) {
                $("#edit-object-form").find("#" + key + "-edit").val(
                    object[key]);
                
                if(key == 'isWarnMsg'){
                    var isWarnMsg = $("#edit-object-form").find("input[id='isWarnMsg-edit']");
                    if(isWarnMsg.length>0){
                        if(object[key] == '1'){
                            $(isWarnMsg).prop("checked",true);
                        }else{
                        	$(isWarnMsg).prop("checked",false);
                        }
                    }
                    $("#iswarn-msg-msg").val(object[key]);
                }

                if(key == 'isWarnMail'){
                    var isWarnMail = $("#edit-object-form").find("input[id='isWarnMail-edit']");
                    if(isWarnMail.length>0){
                        if(object[key] == '1'){
                            $(isWarnMail).prop("checked",true);
                        }else{
                        	$(isWarnMail).prop("checked",false);
                        }
                    }
                    $("#isWarn-mail-msg").val(object[key]);;
                }

                if(key == 'isWarnOnline'){
                    var isWarnOnline = $("#edit-object-form").find("input[id='isWarnOnline-edit']");
                    if(isWarnOnline.length > 0){
                        if(object[key] == '1'){
                            $(isWarnOnline).prop("checked",true);
                        }else{
                        	$(isWarnOnline).prop("checked",false);
                        }
                    }
                    $("#isWarn-online-msg").val(object[key]);;
                }

                if(key == 'beginTime'){
                    var begTime = object[key].substr(0,16);
                    $("#beginTime-edit").val(begTime);
                }
                if(key == 'endTime'){
                    var endTime = object[key].substr(0,16);
                    $("#endTime-edit").val(endTime);
                }
            }
            var index = layer.open({
                title : '编辑',
                maxmin : false,
                type : 1,
                content : $('#win-editinside-object')
            });
            pform.render();
            layer.full(index);
        }

        //删除单个
        function showDelete(id,myself) {
        	pageBtn = myself;
            layer.confirm('确定并删除?', {
                icon : 3,
                title : '提示'
            }, function(index) {
                var retMsg = tool.deleteByIds("/mee/meeInsideMeetingDraft/delete", id)
                if (retMsg.code == 0) {
                	var laypageBtn=$(pageBtn).parents(".admin-table").parent().next().find(".layui-laypage-btn");
                	if(laypageBtn.length>0){
                		laypageBtn.trigger("click");
                	}else{
                		loadDraftData();
                	}
                    tool.success(retMsg.message);
                    layer.closeAll();
                } else {
                    tool.error(retMsg.message);
                }
            });
        }

        //批量删除公共信息草稿
        function deleteBatchDraft() {
            if ($(".moreInput:checked").length == 0) {
                tool.error('至少选中一个');
            } else {
                var str = "";
                $(".moreInput:checked").each(function (index, value) {
                    str += value.id + ";";
                })
                //调批量删除接口 最后重新渲染列表

                layer.confirm('确定删除吗 ?', {
                    icon: 3,
                    title: '提示'
                }, function (index) {
                    var retMsg = tool.deleteByIds("/mee/meeInsideMeetingDraft/delete", str)
                    if (retMsg.code == 0) {
                    	$("#paging_check-all").attr("checked",false);
                    	pform.render();
                        tool.success(retMsg.message);
                        layer.closeAll();
                        loadDraftData();
                    } else {
                        tool.error(retMsg.message);
                    }
                });
            }
        }


		/* 高级搜索 */
		function search_h(){
			$(".sear").toggle();
		}

        //阻止maopao
        function defalt_td(event){
            event.cancelBubble=true;
        }
        //查看会议室试用情况
        function checkmeeroom(){
        	  var index = layer.open({
                  title : '会议室使用情况',
                  maxmin : false,
                  type : 1,
                  content : $('#win-checkroom-object')
              });
              pform.render();
             layer.full(index);
             var meetingRoomId = $("#meetingRoomId-add").val();
            loadCountData(1,meetingRoomId);
        }
        
        function aleafile(id,myself,index){
            layer.confirm('确定删除吗 ?', {
                icon: 3,
                title: '提示'
            }, function (index) {
                var retMsg = tool.deleteById("/res/resResource/delete", id);
                if (retMsg.code == 0) {
                    tool.success(retMsg.message);
                    $(myself).parent().parent().remove();
                    for(var i=0;i<arr.length;i++){
                        if(arr[i].index==index){
                            arr.splice(i,1)
                        }
                    }
                    for(var i=0;i<nameArr.length;i++){
                        if(nameArr[i].index==index){
                            nameArr.splice(i,1)
                        }
                    }
                } else {
                    tool.error(retMsg.message);
                }
            });
        }
	</script>
</body>
</html>
